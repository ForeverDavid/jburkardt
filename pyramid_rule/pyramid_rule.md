PYRAMID\_RULE\
Generate a Quadrature Rule for a Pyramid {#pyramid_rule-generate-a-quadrature-rule-for-a-pyramid align="center"}
========================================

------------------------------------------------------------------------

**PYRAMID\_RULE** is a C++ program which generates a quadrature rule
over the interior of a pyramid in 3D.

The quadrature rules generated by **PYRAMID\_RULE** are all examples of
*conical product rules*, and involve a kind of direct product of the
form:

> Legendre rule in X \* Legendre rule in Y \* Jacobi rule in Z

where the Jacobi rule includes a factor of (1-Z)\^2.

The integration region is:

           - ( 1 - Z ) <= X <= 1 - Z
           - ( 1 - Z ) <= Y <= 1 - Z
                     0 <= Z <= 1.
           

When Z is zero, the integration region is a square lying in the (X,Y)
plane, centered at (0,0,0) with "radius" 1. As Z increases to 1, the
radius of the square diminishes, and when Z reaches 1, the square has
contracted to the single point (0,0,1).

### Usage: {#usage align="center"}

> **pyramid\_rule** *legendre\_order* *jacobi\_order* *filename*

where

-   *legendre\_order* is the order of the 1D Legendre quadrature rule to
    be used. The X and Y dimensions will use a product of this rule.
-   *jacobi\_order* is the order of the 1D Jacobi quadrature rule to be
    used. The Z dimension will use this rule which will include a factor
    of (1-X)\^2 which accounts for the narrowing of the pyramid.
-   *filename* is the common prefix for the files containing the region,
    weight and abscissa information of the quadrature rule;

### Licensing: {#licensing align="center"}

The computer code and data files described and made available on this
web page are distributed under [the GNU LGPL
license.](../../txt/gnu_lgpl.txt)

### Languages: {#languages align="center"}

**PYRAMID\_RULE** is available in [a C
version](../../c_src/pyramid_rule/pyramid_rule.md) and [a C++
version](../../master/pyramid_rule/pyramid_rule.md) and [a FORTRAN77
version](../../f77_src/pyramid_rule/pyramid_rule.md) and [a FORTRAN90
version](../../f_src/pyramid_rule/pyramid_rule.md) and [a MATLAB
version.](../../m_src/pyramid_rule/pyramid_rule.md)

### Related Data and Programs: {#related-data-and-programs align="center"}

[CUBE\_FELIPPA\_RULE](../../master/cube_felippa_rule/cube_felippa_rule.md),
a C++ library which returns the points and weights of a Felippa
quadrature rule over the interior of a cube in 3D.

[PYRAMID\_EXACTNESS](../../master/pyramid_exactness/pyramid_exactness.md),
a C++ program which investigates the polynomial exactness of a
quadrature rule over the interior of the unit pyramid in 3D.

[PYRAMID\_FELIPPA\_RULE](../../master/pyramid_felippa_rule/pyramid_felippa_rule.md),
a C++ library which returns Felippa's quadratures rules for
approximating integrals over the interior of a pyramid in 3D.

[PYRAMID\_GRID](../../master/pyramid_grid/pyramid_grid.md), a C++
library which computes a grid of points over the interior of the unit
pyramid in 3D;

[PYRAMID\_INTEGRALS](../../master/pyramid_integrals/pyramid_integrals.md),
a C++ library which returns the exact value of the integral of any
monomial over the interior of the unit pyramid in 3D.

[PYRAMID\_MONTE\_CARLO](../../master/pyramid_monte_carlo/pyramid_monte_carlo.md),
a C++ library which applies a Monte Carlo method to estimate integrals
of a function over the interior of the unit pyramid in 3D;

[QUADRATURE\_RULES\_PYRAMID](../../datasets/quadrature_rules_pyramid/quadrature_rules_pyramid.md),
a dataset directory which contains quadrature rules over the interior of
the unit pyramid in 3D.

[SQUARE\_FELIPPA\_RULE](../../master/square_felippa_rule/square_felippa_rule.md),
a C++ library which returns the points and weights of a Felippa
quadrature rule over the interior of a square in 2D.

[STROUD](../../master/stroud/stroud.md), a C++ library which defines
quadrature rules for a variety of unusual areas, surfaces and volumes in
2D, 3D and N-dimensions.

[TETRAHEDRON\_FELIPPA\_RULE](../../master/tetrahedron_felippa_rule/tetrahedron_felippa_rule.md),
a C++ library which returns Felippa's quadratures rules for
approximating integrals over the interior of a tetrahedron in 3D.

[TRIANGLE\_FEKETE\_RULE](../../master/triangle_fekete_rule/triangle_fekete_rule.md),
a C++ library which defines Fekete rules for interpolation or quadrature
over the interior of a triangle in 2D.

[TRIANGLE\_FELIPPA\_RULE](../../master/triangle_felippa_rule/triangle_felippa_rule.md),
a C++ library which returns Felippa's quadratures rules for
approximating integrals over the interior of a triangle in 2D.

[WEDGE\_FELIPPA\_RULE](../../master/wedge_felippa_rule/wedge_felippa_rule.md),
a C++ library which returns quadratures rules for approximating
integrals over the interior of the unit wedge in 3D.

### Reference: {#reference align="center"}

1.  Carlos Felippa,\
    A compendium of FEM integration formulas for symbolic work,\
    Engineering Computation,\
    Volume 21, Number 8, 2004, pages 867-890.
2.  Arthur Stroud,\
    Approximate Calculation of Multiple Integrals,\
    Prentice Hall, 1971,\
    ISBN: 0130438936,\
    LC: QA311.S85.

### Source Code: {#source-code align="center"}

-   [pyramid\_rule.cpp](pyramid_rule.cpp), the source code.

### List of Routines: {#list-of-routines align="center"}

-   **MAIN** is the main program for PYRAMID\_RULE.
-   **DTABLE\_WRITE0** writes a DTABLE file with no header.
-   **JACOBI\_COMPUTE** computes a Jacobi quadrature rule.
-   **JACOBI\_RECUR** evaluates a Jacobi polynomial.
-   **JACOBI\_ROOT** improves an approximate root of a Jacobi
    polynomial.
-   **LEGENDRE\_COMPUTE** computes a Legendre quadrature rule.
-   **PYRAMID\_HANDLE** computes the requested pyramid rule and outputs
    it.
-   **R8\_ABS** returns the absolute value of an R8.
-   **R8\_EPSILON** returns the R8 roundoff unit.
-   **R8\_GAMMA** evaluates Gamma(X) for a real argument.
-   **TIMESTAMP** prints the current YMDHMS date as a time stamp.

You can go up one level to [the C++ source codes](../cpp_src.md).

------------------------------------------------------------------------

*Last revised on 23 July 2009.*
